# Equivalent DOIS Base

var_weekly

w_ern_dois_rtes
w_wk

SUM(w_ern_dois_rtes) / COUNT(w_wk) AS w_ern_dois_rtes

Calculation Description:
Calculates the average DOIS earned routes per week across the selected fiscal week range.



# Earned Routes – Equivalent Workload

var_calc_cdv, var_weekly, avar_cdv_prod

cd_ern_hrs_ldc21
cd_ern_hrs_ldc22
cd_ern_hrs_ldc26
w_del_days
prod_fters_fact

CASE WHEN b_collection_unit_ind = 1 THEN 0
ELSE
  (((SUM(cd_ern_hrs_ldc21 + cd_ern_hrs_ldc22 + cd_ern_hrs_ldc26)
      * prod_fters_fact)
     / SUM(w_del_days)) / 8)
END AS structEarned

Calculation Description:
Converts earned office/street hours into equivalent earned routes:
Sum earned hours (21 + 22 + 26)
Adjust by productivity factor (prod_fters_fact)
Divide by delivery days to normalize daily
Divide by 8 hours to convert to route equivalents


# Actual Routes – Equivalent Work Hours

var_weekly, avar_cdv_prod

w_hrs_ldc21
w_hrs_ldc22
w_hrs_ldc26
w_hrs_ldc29
w_del_days
prod_fters_fact


CASE WHEN b_collection_unit_ind = 1 THEN 0
ELSE
  (((SUM(w_hrs_ldc21 + w_hrs_ldc22 + w_hrs_ldc26 + w_hrs_ldc29)
      * prod_fters_fact)
     / SUM(w_del_days)) / 8)
END AS actRoutes


Calculation Description:
Converts actual office/street hours into equivalent actual routes:
Sum actual LDC hours (21 + 22 + 26 + 29)
Apply productivity factor
Normalize per delivery day
Convert hours to route equivalents (÷ 8)


# Daily Pivot Opportunity


CASE WHEN b_collection_unit_ind = 1 THEN 0
ELSE
  ((SUM(w_ern_dois_rtes) / COUNT(w_wk))
   - (((SUM(cd_ern_hrs_ldc21 + cd_ern_hrs_ldc22 + cd_ern_hrs_ldc26)
        * prod_fters_fact)
       / SUM(w_del_days)) / 8))
END AS ProjActRteReduction


This represents the daily route reduction opportunity based on earned workload compared to DOIS route structure.





CASE 
  WHEN b_vol_dps_pcs = 0 THEN 0
  ELSE 
    CAST(b_vol_dps_pcs AS DECIMAL(18,2)) /
    ((b_am_cas_ltr_pcs + b_pm_cas_ltr_pcs) + b_vol_dps_pcs)
END AS bdps_pct


CASE 
  WHEN SUM(w_vol_dps_ltr) = 0 THEN 0
  ELSE
    1 - (
      CAST(SUM(cd_ern_cas_ltr_pcs) AS DECIMAL(18,2)) /
      (SUM(w_vol_cas_ltr) + SUM(w_vol_dps_ltr))
    )
END AS adps_pct











--Base Total Manual Volume

CASE 
  WHEN (b_am_cas_ltr_pcs + b_pm_cas_ltr_pcs
      + b_am_cas_flt_pcs + b_pm_cas_flt_pcs
      + b_vol_dps_pcs + b_vol_fss_pcs) = 0
  THEN 0
  ELSE
    (b_am_cas_ltr_pcs + b_pm_cas_ltr_pcs
   + b_am_cas_flt_pcs + b_pm_cas_flt_pcs)
    / CAST(
        (b_am_cas_ltr_pcs + b_pm_cas_ltr_pcs
       + b_am_cas_flt_pcs + b_pm_cas_flt_pcs
       + b_vol_dps_pcs + b_vol_fss_pcs) 
      AS DECIMAL(18,2)
      )
END AS bManVolPct



--Actual Total Manual Volume PCT

CASE 
  WHEN SUM(w_vol_dps_ltr + w_vol_dps_flt + w_vol_cas_flt + w_vol_cas_ltr) = 0
  THEN 0
  ELSE
    SUM(w_vol_cas_flt + w_vol_cas_ltr)
    / CAST(
        SUM(w_vol_dps_ltr + w_vol_dps_flt + w_vol_cas_flt + w_vol_cas_ltr)
      AS DECIMAL(18,2)
      )
END AS aManVolPct



#Variance B

Variance/B (percentage points) = (ActualPct − BasePct) × 100


# Percentage variance B

% Variance/B = ((ActualPct − BasePct) / BasePct) × 100











tot_e2b_hrs = tot_eofc_hrs + ern22 + tot_eother_hrs
where:
  tot_eofc_hrs = ern21 + ern26
  ern21 = SUM(cd_ern_hrs_ldc21)
  ern26 = SUM(cd_ern_hrs_ldc26)
  ern22 = SUM(cd_ern_hrs_ldc22)
  tot_eother_hrs = ern23 + ern27
  ern23 = SUM(cd_ern_hrs_ldc23)
  ern27 = SUM(cd_ern_hrs_ldc27)






tot_b2b_hrs = tot_bofc_hrs + bas22 + tot_bother_hrs
where:
  tot_bofc_hrs = bas21 + bas26 + bas29
  bas21 = b_hrs_ldc21 * SUM(w_del_days)
  bas26 = b_hrs_ldc26 * SUM(w_del_days)
  bas29 = b_hrs_ldc29 * SUM(w_del_days)
  bas22 = b_hrs_ldc22 * SUM(w_del_days)
  tot_bother_hrs = bas23 + bas27
  bas23 = b_oth_23 * SUM(w_del_days)
  bas27 = b_oth_27 * SUM(w_del_days)



Sum of all base (planned) Function-2B hours across Office (LDC21/26/29), Street (LDC22) and Other (LDC23+27). Each basXX is the unit’s base hours-per-day from var_base multiplied by the total delivery days (SUM(w_del_days)) in the selected FY/WK window.




tot_a2b_hrs = tot_aofc_hrs + act22 + tot_aother_hrs
where:
  tot_aofc_hrs = act21 + act26 + act29
  act21 = SUM(w_hrs_ldc21)
  act26 = SUM(w_hrs_ldc26)
  act29 = SUM(w_hrs_ldc29)
  act22 = SUM(w_hrs_ldc22)
  tot_aother_hrs = act23 + act27
  act23 = SUM(w_hrs_ldc23)
  act27 = SUM(w_hrs_ldc27)



Sum of actual observed Function-2B hours from weekly actual hours (var_weekly) across office, street and other LDCs for the window.



tot_var2b_hrs = tot_ofc_var_hrs + ldc22_var_hrs + tot_var_other_hrs
where (from the query/CFML):
  tot_ofc_var_hrs  ≈ rt_pivot_perf_dly_act  -- implemented in SELECT as:
    rt_pivot_perf_dly_act =
      (getBase.BaseHours)
      - ( ( (CAST(SUM(w_hrs_ldc21 + w_hrs_ldc22 + w_hrs_ldc26 + w_hrs_ldc29) AS DECIMAL(18,2)) / SUM(w_del_days)) / 8 )
          * prod_fters_fact )
  ldc22_var_hrs = act22 - ern22
  tot_var_other_hrs = tot_aother_hrs - tot_eother_hrs


ggregate opportunity/variance across Function-2B:

tot_ofc_var_hrs is the office pivot/variance computed by subtracting the actual-derived route-hour equivalent (normalized by delivery days, converted to FTER and scaled by prod_fters_fact) from the baseline total hours (getBase.BaseHours).

ldc22_var_hrs is the street (LDC22) actual minus earned.

tot_var_other_hrs is the Other hours actual minus earned (23+27).
